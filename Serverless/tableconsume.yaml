metadata:
  name: tableconsume
  labels:
    nuclio.io/project-name: cd3e5ff2-6566-43c3-995f-89170a71895e
spec:
  handler: "main:Handler"
  runtime: golang
  env:
    - name: RabbitMQURL
      value: "amqp://guest:guest@192.168.68.112:5672"
    - name: RabbitMQEnterQ
      value: iot/rmq/tables
  resources: {}
  image: "nuclio/processor-tableconsume:latest"
  minReplicas: 1
  maxReplicas: 1
  targetCPU: 75
  triggers:
    "mqtt trigger":
      class: ""
      kind: mqtt
      url: "guest:guest@192.168.68.112:1883"
      username: guest
      password: guest
      attributes:
        subscriptions:
          - qos: 0
            topic: iot/sensors/tables
  build:
    image: ""
    noCache: false
    offline: false
    dependencies: []
    runtimeAttributes:
      repositories: []
    functionSourceCode: Ly8gVGhpcyBmdW5jdGlvbiByZWFkIHRoZSB2YWx1ZXMgcG9zdGVkIG9uIGEgbXF0dCBxdWV1ZS4KLy8gVGhlbiBkZWZpbmUgYW4gQU1RUCBxdWV1ZSBhbmQgcG9zdCB0aGVyZSB0aGUgbWVzc2FnZSByZWNlaXZlZAovLyB3aXRoIGFkZGl0aW9uYWwgaW5mby4KCi8vIE1RVFQgSlNPTiBtZXNzYWdlIHN0cnVjdHVyZToKLy8gewovLyAgICAic3RhdHVzIjoib3Blbi9jbG9zZSIsCi8vICAgICJ0YWJsZSI6IjEvMi8zLzQuLi4iLAovLyAgICAic2VhdCI6IjEvMi8zLzQuLi4iCi8vIH0KLy8gCi8vIEFNUVAgSlNPTiBtZXNzYWdlIHN0cnVjdHVyZToKLy8gewovLyAgICAgICJ0YWJsZSI6IjEvMi8zLzQuLi4iCi8vICAgICAgInN0YXR1cyI6Im9wZW4vY2xvc2UiLAovLyAgICAgICJzZWF0IjoiMS8yLzMvNC4uLiIKLy8gICAgICAidGltZXN0YW1wIjoieHh4eHh4eHh4eHh4eCIKLy8gfQovLwovLyBFTlYgdmFyczoKLy8gIFJhYmJpdE1RVVJMOiByYWJiaXRtcSBlbmRwb2ludCBhbXFwOi8vdXNlcm5hbWU6cGFzc3dvcmRAZW5kcG9pbnQ6cG9ydCBlZy4gYW1xcDovL2d1ZXN0Omd1ZXN0QDE5Mi4xNjguNjguMTEyOjU2NzIKLy8gIFJhYmJpdE1RRW50ZXJROiBhbXFwIHF1ZXVlIG5hbWUgZWcuIGlvdC9ybXEvZW50ZXIKLy8KCnBhY2thZ2UgbWFpbgoKaW1wb3J0ICgKCSJlbmNvZGluZy9qc29uIgoJImZtdCIKCSJvcyIKICAgICJzdHJjb252IgoJInRpbWUiCgoJImdpdGh1Yi5jb20vbnVjbGlvL251Y2xpby1zZGstZ28iCgkiZ2l0aHViLmNvbS9zdHJlYWR3YXkvYW1xcCIKKQoKdHlwZSB0YWJsZW1zZyBzdHJ1Y3QgewoJU3RhdHVzIHN0cmluZyBganNvbjoic3RhdHVzImAKICAgIFRhYmxlICBzdHJpbmcgYGpzb246InRhYmxlImAKICAgIFNlYXQgICBzdHJpbmcgYGpzb246InNlYXQiYAp9Cgp0eXBlIERvb3JNUSBzdHJ1Y3QgewoJVGFibGUgICAgIHN0cmluZyBganNvbjoidGFibGUiYAoJU3RhdHVzICAgIHN0cmluZyBganNvbjoic3RhdHVzImAKICAgIFNlYXQgICAgICBzdHJpbmcgYGpzb246InNlYXQiYAoJVGltZXN0YW1wIHN0cmluZyBganNvbjoidGltZXN0YW1wImAKfQoKZnVuYyBIYW5kbGVyKGNvbnRleHQgKm51Y2xpby5Db250ZXh0LCBldmVudCBudWNsaW8uRXZlbnQpIChpbnRlcmZhY2V7fSwgZXJyb3IpIHsKCWZtdC5QcmludGxuKCJTdGFydGluZyBHbyBhcHBsaWNhdGlvbiIsIHN0cmluZyhldmVudC5HZXRCb2R5KCkpKQoKCW1zZyA6PSAmdGFibGVtc2d7fQoJanNvbi5Vbm1hcnNoYWwoZXZlbnQuR2V0Qm9keSgpLCBtc2cpCgljb25uLCBlcnIgOj0gYW1xcC5EaWFsKG9zLkdldGVudigiUmFiYml0TVFVUkwiKSkKCglpZiBlcnIgIT0gbmlsIHsKCQlwYW5pYyhlcnIpCgl9CglkZWZlciBjb25uLkNsb3NlKCkKCglmbXQuUHJpbnRsbigiU3VjY2Vzc2Z1bGx5IENvbm5lY3RlZCB0byBSYWJiaXRNUSIpCgoJY2gsIGVyciA6PSBjb25uLkNoYW5uZWwoKQoKCWlmIGVyciAhPSBuaWwgewoJCXBhbmljKGVycikKCX0KCWRlZmVyIGNoLkNsb3NlKCkKCglxLCBlcnIgOj0gY2guUXVldWVEZWNsYXJlKAoJCW9zLkdldGVudigiUmFiYml0TVFFbnRlclEiKSwKCQlmYWxzZSwKCQlmYWxzZSwKCQlmYWxzZSwKCQlmYWxzZSwKCQluaWwsCgkpCgoJaWYgZXJyICE9IG5pbCB7CgkJcGFuaWMoZXJyKQoJfQoKCWZtdC5QcmludGYoIlByaW50aW5nIHF1ZXVlIGluZm8gJXNcbiIsIHEpCglmbXQuUHJpbnRmKCJNRVNTQUdFICVzICVzICVzICV2XG4iLCBtc2cuVGFibGUsIG1zZy5TdGF0dXMsIG1zZy5TZWF0LCBtc2cpCgogICAgbXNnanNvbmVuYywgZXJyIDo9IGpzb24uTWFyc2hhbChEb29yTVF7CgkJCQlUYWJsZTogICAgIG1zZy5UYWJsZSwKCQkJCVN0YXR1czogICAgbXNnLlN0YXR1cywKICAgICAgICAgICAgICAgIFNlYXQ6ICAgICAgbXNnLlNlYXQsCgkJCQlUaW1lc3RhbXA6IHN0cmNvbnYuSXRvYShpbnQodGltZS5Ob3coKS5Vbml4TmFubygpIC8gaW50NjQodGltZS5NaWxsaXNlY29uZCkpKSwKCX0pCiAgICAKICAgIGlmIGVyciAhPSBuaWwgewoJCXBhbmljKGVycikKCX0KICAgIAoJLy8gcHVibGlzaCBtZXNzYWdlCgllcnIgPSBjaC5QdWJsaXNoKAoJCSIiLAoJCW9zLkdldGVudigiUmFiYml0TVFFbnRlclEiKSwKCQlmYWxzZSwKCQlmYWxzZSwKCQlhbXFwLlB1Ymxpc2hpbmd7CgkJCUNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24vanNvbiIsCgkJCUJvZHk6bXNnanNvbmVuYywKCQl9LAoJKQoKCWlmIGVyciAhPSBuaWwgewoJCXBhbmljKGVycikKCX0KCglmbXQuUHJpbnRsbigiU3VjY2Vzc2Z1bGx5IFB1Ymxpc2hlZCB0byBSYWJiaXRNUSIpCglyZXR1cm4gbmlsLCBuaWwKfQoK
    codeEntryType: sourceCode
  platform: {}
  readinessTimeoutSeconds: 60
